%Derivadas parciales
c = 5.23;
varc = 4.37;
phi = deg2rad(22.54);
varphi = deg2rad(37.97);
gamma = 19.17;
vargamma = 0.84;

FSc = (7*cot(phi)*(((1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7) - 1)/((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1) + (1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7))*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)*(((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2)/(6*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)) + 1))/500 + (7*c*cot(phi)*((3600*cot(phi)*(1 - 500/((9*c*cot(phi))/10 + 1100))^(1/7))/(7*((9*c*cot(phi))/10 + 1100)^2) + (3600*cot(phi)*(1 - 500/((9*c*cot(phi))/10 + 1100))^(1/7))/(7*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)*((9*c*cot(phi))/10 + 1100)^2))*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)*(((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2)/(6*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)) + 1))/500 + (81*gamma*cot(phi)*tan(phi)*(1 - 500/((3*c*cot(phi))/5 + 1100))^(8/7)*(2*(3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 + 2))/(56*((3*c*cot(phi))/5 + 1100)^2) + (18*(3060513257434037/1125899906842624)^(pi*tan(phi))*gamma*tan(phi/2 + pi/4)^2*cot(phi)*(1 - 500/((9*c*cot(phi))/10 + 1100))^(1/7)*(2*tan(phi)*(sin(phi) - 1)^2 + 1)*(tan(phi)/6 + 1))/(7*((9*c*cot(phi))/10 + 1100)^2);
FSphi = (9*gamma*(1 - 500/((3*c*cot(phi))/5 + 1100))^(15/7)*(tan(phi)^2 + 1)*(2*(3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 + 2))/4000 + (9*gamma*tan(phi)*(1 - 500/((3*c*cot(phi))/5 + 1100))^(15/7)*(4*(3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)*(tan(phi/2 + pi/4)^2/2 + 1/2) + 2*(3060513257434037/1125899906842624)^(pi*tan(phi))*pi*tan(phi/2 + pi/4)^2*log(3060513257434037/1125899906842624)*(tan(phi)^2 + 1)))/4000 + (7*c*cot(phi)*(((1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7) - 1)/((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1) + (1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7))*(2*(3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)*(tan(phi/2 + pi/4)^2/2 + 1/2) + (3060513257434037/1125899906842624)^(pi*tan(phi))*pi*tan(phi/2 + pi/4)^2*log(3060513257434037/1125899906842624)*(tan(phi)^2 + 1))*(((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2)/(6*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)) + 1))/500 - (7*c*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)*(((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2)/(6*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)) + 1)*(((2*(3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)*(tan(phi/2 + pi/4)^2/2 + 1/2) + (3060513257434037/1125899906842624)^(pi*tan(phi))*pi*tan(phi/2 + pi/4)^2*log(3060513257434037/1125899906842624)*(tan(phi)^2 + 1))*((1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7) - 1))/((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)^2 + (3600*c*(1 - 500/((9*c*cot(phi))/10 + 1100))^(1/7)*(cot(phi)^2 + 1))/(7*((9*c*cot(phi))/10 + 1100)^2) + (3600*c*(1 - 500/((9*c*cot(phi))/10 + 1100))^(1/7)*(cot(phi)^2 + 1))/(7*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)*((9*c*cot(phi))/10 + 1100)^2)))/500 + (7*c*cot(phi)*(((1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7) - 1)/((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1) + (1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7))*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)*(((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2*(cot(phi)^2 + 1))/(6*cot(phi)^2*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)) - ((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2*(2*(3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)*(tan(phi/2 + pi/4)^2/2 + 1/2) + (3060513257434037/1125899906842624)^(pi*tan(phi))*pi*tan(phi/2 + pi/4)^2*log(3060513257434037/1125899906842624)*(tan(phi)^2 + 1)))/(6*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)^2) + ((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)*(tan(phi/2 + pi/4)^2/2 + 1/2))/(3*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)) + ((3060513257434037/1125899906842624)^(pi*tan(phi))*pi*tan(phi/2 + pi/4)^2*log(3060513257434037/1125899906842624)*(tan(phi)^2 + 1))/(6*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1))))/500 - (7*c*(((1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7) - 1)/((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1) + (1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7))*(cot(phi)^2 + 1)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)*(((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2)/(6*cot(phi)*((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 - 1)) + 1))/500 + ((3060513257434037/1125899906842624)^(pi*tan(phi))*gamma*tan(phi/2 + pi/4)^2*(1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7)*(2*(sin(phi) - 1)^2*(tan(phi)^2 + 1) + 4*cos(phi)*tan(phi)*(sin(phi) - 1))*(tan(phi)/6 + 1))/200 + ((3060513257434037/1125899906842624)^(pi*tan(phi))*gamma*tan(phi/2 + pi/4)^2*(tan(phi)^2/6 + 1/6)*(1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7)*(2*tan(phi)*(sin(phi) - 1)^2 + 1))/200 - (81*c*gamma*tan(phi)*(1 - 500/((3*c*cot(phi))/5 + 1100))^(8/7)*(cot(phi)^2 + 1)*(2*(3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 + 2))/(56*((3*c*cot(phi))/5 + 1100)^2) + ((3060513257434037/1125899906842624)^(pi*tan(phi))*gamma*tan(phi/2 + pi/4)*(1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7)*(2*tan(phi)*(sin(phi) - 1)^2 + 1)*(tan(phi/2 + pi/4)^2/2 + 1/2)*(tan(phi)/6 + 1))/100 - (18*(3060513257434037/1125899906842624)^(pi*tan(phi))*c*gamma*tan(phi/2 + pi/4)^2*(1 - 500/((9*c*cot(phi))/10 + 1100))^(1/7)*(2*tan(phi)*(sin(phi) - 1)^2 + 1)*(cot(phi)^2 + 1)*(tan(phi)/6 + 1))/(7*((9*c*cot(phi))/10 + 1100)^2) + ((3060513257434037/1125899906842624)^(pi*tan(phi))*gamma*pi*tan(phi/2 + pi/4)^2*log(3060513257434037/1125899906842624)*(1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7)*(2*tan(phi)*(sin(phi) - 1)^2 + 1)*(tan(phi)/6 + 1)*(tan(phi)^2 + 1))/200;
FSgamma = (9*tan(phi)*(1 - 500/((3*c*cot(phi))/5 + 1100))^(15/7)*(2*(3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2 + 2))/4000 + ((3060513257434037/1125899906842624)^(pi*tan(phi))*tan(phi/2 + pi/4)^2*(1 - 500/((9*c*cot(phi))/10 + 1100))^(8/7)*(2*tan(phi)*(sin(phi) - 1)^2 + 1)*(tan(phi)/6 + 1))/200;
vFS = (((FSc)^2)*varc) + (((FSgamma)^2)*vargamma)+(((FSphi)^2)*varphi);
P = sqrt( vFS );

Df = 0.5;
B = 0.5; %Insert B-Value
L = 3; %Insert L-Value
HB = 0;
HL = 500;
V = 1100; 
%Vesic F.C Portante
Nq = exp(1)^(pi*tan(phi))*(tan(deg2rad(45)+(phi/2)))^2;
Nc = (Nq-1)*cot(phi);
Ngamma = 2*(Nq+1)*tan(phi);
%Factores de Forma
Sc = 1+(Nq/Nc)*(B/L);
Sq = 1+(B/L)*tan(phi);
Sgamma = 0.9;
%Factores de Inclinaci√≥n
m = (2+(L/B))/(1+(L/B));
Iq = (1-(HL/(V+B*L*0.6*c*cot(phi))))^m;
Igamma = (1-(HL/(V+0.6*c*cot(phi))))^(m+1);
Ic = Iq-((1-Iq)/(Nq-1));
%Factores de Profundidad
k = 1;
Dc = 1+0.4*k;
Dq = 1+(2*tan(phi))*(((1-sin(phi))^2)*k);
Dgamma = 1;
%Capacidad Portante
q = gamma*Df;
qult = (c*Nc*Sc*Dc*Ic)+(q*Nq*Sq*Dq*Iq)+(0.5*gamma*B*Ngamma*Sgamma*Igamma);
qadm = 100;
FS = qult/qadm;
%Series de taylor
x = -25:.1:25;
y = pdf('Normal',x,FS,P);
plot(x,y)
z = cdf('Normal',x,FS,P);
plot(x,z)